---
- name: get spec file
  find:
    pattern: "*.spec"
    path: "{{ inventory_dir }}/packages/{{ inventory_hostname }}"
  register: spec_file
  tags:
    - always

- name: "Set spec file path, scl options and releasers"
  set_fact:
    spec_file_path: "{{ spec_file.files[0].path }}"
    scl_prefix_option_str: "{{ '--define \"scl_prefix tfm-\"' if inventory_hostname.startswith('tfm-') else '' }}"
    joined_releasers: "{{ releasers | join(' ') }}"
  tags:
    - always

- include_tasks: dist.yml
  with_items: "{{ diff_brew_pkg_dists }}"
  tags:
    - always
